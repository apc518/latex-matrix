<!doctype html>

<html>
	<head>	
		<script>
			addEvents = () => {
				window.addEventListener("keyup", function(event) {
					event.preventDefault();
					if (event.keyCode == 13) {
						document.getElementById("gen-latex").click();
					}
				});
			}

			genTable = () => {
				let table = document.getElementById('table');
				let rows = document.getElementById('rows').value;
				let cols = document.getElementById('cols').value;

				table.innerHTML = "";

				let table_wip = document.createElement('table');
				for(let i = 0; i < rows; i++) {
					let tr = document.createElement('tr');
					for(let j = 0; j < cols; j++) {
						let td = document.createElement('td');
						let input = document.createElement('input');
						input.type = 'text';
						input.style.width = "30px";
						input.value = `${String.fromCharCode(97+i)}_${j+1}`;
						td.appendChild(input);
						tr.appendChild(td);
					}
					table_wip.appendChild(tr);
				}
				table.appendChild(table_wip);
			}

			genLatex = () => {
				let table = document.getElementById('table').children[0];
				let matrix_type = document.getElementById('matrix-value').value;
				let latex = `$\\begin{${matrix_type}}\n`;
				let rows = table.children;
				for (let row = 0; row < rows.length; row++ ){
					let cols = rows[row].children;
					for(let col = 0; col < cols.length; col++) {
						let val = cols[col].children[0].value;
						if (val.indexOf('/') != -1) {
							let vals = val.split('/');
							val = `\\frac{${vals[0]}}{${vals[1]}}`
						}
						latex += `${val}`;
						if (col == cols.length - 1) {
							if (row == rows.length - 1) {
								latex += " \n";
							} else {
								latex += " \\\\\n";
							}
						} else {
							latex += " & ";
						}
					}
				}
				latex += `\\end{${matrix_type}} $`

				document.getElementById("latex").value = latex;
			}
		</script>
	</head>
	<body onload="addEvents();genTable();" >
		<label>Type 
			<select id='matrix-value'>
				<option value="matrix">matrix</option>
				<option value="pmatrix">pmatrix</option>
				<option value="bmatrix" selected>bmatrix</option>
				<option value="Bmatrix">Bmatrix</option>
				<option value="vmatrix">vmatrix</option>
				<option value="Vmatrix">Vmatrix</option>
			</select>
		</label>
		<label>Rows 
			<input type="number" id="rows" value="3" style="width:30px;" onchange="genTable();">
		</label>
		<label>Cols 
			<input type="number" id="cols" value="3" style="width:30px;" onchange="genTable();">
		</label>
		
		<div id="table"></div>
		<button id="gen-latex" onclick="genLatex()">Generate Latex</button>
		<div>
			<textarea id="latex" cols="40" rows="20"></textarea>
		</div>
	</body>
</html>